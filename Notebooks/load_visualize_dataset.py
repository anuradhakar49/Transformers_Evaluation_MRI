# -*- coding: utf-8 -*-
"""load_visualize_dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1_watBHmFzpGvFREGCiIKBc1T7gO2nVev

# Python scripts to load and visualize MRI Classification and segmentation datasets
"""

!pip install -U datasets

"""## 1. Python script to load and visualize an MRI classification dataset(with train, test, validation data)"""

from huggingface_hub import login
import os
import numpy as np
import matplotlib.pyplot as plt
from datasets import load_dataset, Dataset
from PIL import Image

login(token='Your HuggingFace Token')
dataset = load_dataset("akar49/MRI_3TumorClassification")

print(dataset)

## Get the label names from the dataset
labels = dataset["train"].features["label"].names
label2id, id2label = dict(), dict()

# Create mappings between label names and indices
for i, label in enumerate(labels):
    label2id[label] = str(i)
    id2label[str(i)] = label

# Print the label names corresponding to indices 0 and 1
print(id2label[str(0)], id2label[str(1)],id2label[str(2)],id2label[str(3)])

3# Extract images and labels from the dataset
i= 10
j= 20
trimg = dataset['train'][i]['image']
lab1 = dataset['train'][i]['label']
teimg = dataset['test'][j]['image']
lab2 = dataset['test'][j]['label']

# Create a figure to display training and test images with labels
fig = plt.figure(figsize=(10, 10))

# Display training image and label
ax1 = fig.add_subplot(221)
ax1.imshow(trimg, cmap='gray')
ax1.set_title('Training image label: ' + str(lab1) + '=' + id2label[str(lab1)])

# Display test image and label
ax2 = fig.add_subplot(222)
ax2.imshow(teimg, cmap='gray')
ax2.set_title('Test image label: ' + str(lab2) + '=' + id2label[str(lab2)])

"""## 2. Python script to load the MRI segmentation dataset (with train, test, validation data)
### Checkpoints for downloading the three tumor datasets:
* ### akar49/MRI_Seg_Meningioma
* ### akar49/MRI_Seg_Glioma
* ### akar49/MRI_Seg_Pituitary

### Function to load dataset:
### dataset = load_dataset("username/dataset_name")
"""

from huggingface_hub import login
import os
import numpy as np
import matplotlib.pyplot as plt
from datasets import load_dataset, Dataset
from PIL import Image

login(token='Your HuggingFace Token')
dataset = load_dataset("akar49/MRI_Seg_Pituitary")

print(dataset)

def visualize_data(dataset, num_samples=10):
    indices = np.random.choice(len(dataset), num_samples, replace=False).tolist()

    fig, axarr = plt.subplots(2, num_samples, figsize=(20, 5))

    for i, idx in enumerate(indices):
        sample = dataset[idx]

        image = sample["image"]
        mask = sample["label"]

        axarr[0, i].imshow(image)
        axarr[0, i].axis('off')

        axarr[1, i].imshow(mask, cmap='gray')
        axarr[1, i].axis('off')

        axarr[0, i].set_title(f'Image #{idx}')
        axarr[1, i].set_title(f'label #{idx}')

    plt.tight_layout()
    plt.show()

visualize_data(dataset['train'])